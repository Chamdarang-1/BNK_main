<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>product_views</title>
    <link rel="stylesheet" href="../css/common/header_style.css">
    <link rel="stylesheet" href="../css/product/product_views.css">
    <link rel="stylesheet" href="../css/common/footer_style.css">
</head>

<body>
    <div id="header"></div>

    <main class="content">
        <div class="detail-wrap">
            <section class="card-top">
                <!-- 왼쪽 카드 -->
                <div class="card-top-left">
                    <div class="card-preview">
                        <img src="https://item.kakaocdn.net/do/8e9c5b6084a4f06c14baf8341edc9062f43ad912ad8dd55b04db6a64cddaf76d"
                            alt="카드 이미지">
                    </div>
                </div>

                <!-- 오른쪽 설명 -->
                <div class="card-top-right">
                    <div class="top-head">
                        <h1 class="card-title">듀.. 가나디 <br>
                            Ganadi the due.. </h1>
                    </div>
                    <p class="card-sub">계획한 모든 일상에 따라오는 할인</p>

                    <div class="top-benefits">
                        <p><span>외식 · 배달 · 편의점</span> <strong>10% 할인</strong></p>
                        <p><span>쇼핑 · 주유 · 생활</span> <strong>5~10% 할인</strong></p>
                        <p><span>공과금 · 디지털구독</span> <strong>10~20% 할인</strong></p>
                    </div>
                </div>
            </section>

            <!-- 연회비 박스 -->
            <div class="annual-box">
                <div class="annual-top">
                    <span class="annual-title">연회비</span>
                    <a href="javascript:void(0)" class="annual-arrow" id="openFee">›</a>
                </div>
                <ul class="annual-rows">
                    <li>
                        <span class="annual-type">Visa</span>
                        <span class="annual-fee-value">본인 300,000원</span>
                    </li>
                    <li>
                        <span class="annual-type">국내전용</span>
                        <span class="annual-fee-value">본인 300,000원</span>
                    </li>
                </ul>
            </div>

            <!-- 카드 발급 유의사항 -->
            <section class="card-notice">
                <header class="card-notice-head" id="cardNoticeToggle">
                    <h3>카드발급 유의사항</h3>
                    <button type="button" class="card-notice-btn" aria-expanded="false">
                        <span class="tri"></span>
                    </button>
                </header>

                <div class="card-notice-body" id="cardNoticeBody">
                    <ul>
                        <li>연회비는 기본연회비와 서비스연회비를 합산해 카드별로 청구됩니다.</li>
                        <li>가족카드 연회비는 없습니다. (가족카드 단독 발급 시 연회비가 부과될 수 있습니다.)</li>
                        <li>후불교통 기능이 있는 카드로만 신청 가능합니다.</li>
                        <li>해외겸용(Mastercard)은 컨택리스 결제를 지원합니다.</li>
                    </ul>
                </div>
            </section>


            <!-- 안내 박스 -->
            <section class="benefit-section">
                <div class="benefit-grid">
                    <article class="benefit-card">
                        <h4>Time Plan 서비스</h4>
                        <ul>
                            <li>DAY 10% 할인 : 카페 / 음식점</li>
                            <li>NIGHT 10% 할인 : 편의점 / 배달앱</li>
                        </ul>
                        <span class="card-more">›</span>
                    </article>

                    <article class="benefit-card">
                        <h4>Daily Plan 서비스</h4>
                        <ul>
                            <li>쇼핑 10% 할인 : 마트 / 온라인쇼핑 / 잡화</li>
                            <li>이동 5% 할인 : 주유 / 카셰어링 / 택시</li>
                            <li>생활 5% 할인 : 병원·약국 / 미용실 / 온라인서점</li>
                        </ul>
                        <span class="card-more">›</span>
                    </article>

                    <article class="benefit-card">
                        <h4>Plan Day 서비스</h4>
                        <ul>
                            <li>매월 1일 Time Plan, Daily Plan 서비스 2배 할인(서비스당 1회)</li>
                        </ul>
                        <span class="card-more">›</span>
                    </article>
                </div>
            </section>


            <section class="card-compare-wrap">
                <div class="compare-title">
                    <h2>이 카드랑 비교해 보세요.</h2>
                    <p>비교할 카드를 선택하면 오른쪽에 표시됩니다.</p>
                </div>

                <div class="compare-body">
                    <!-- 현재 카드 -->
                    <div class="compare-card current-card" id="currentCard">
                        <p class="label">현재 보고 있는 카드</p>
                        <!-- 이미지 경로만 넣어둠 -->
                        <div class="card-box"
                            data-card-img="https://i.namu.wiki/i/IAJvonqqxo949GavmMtyQOX05yvPs8vXZpJWZ5orEB4ZUMzsEUpj3D6osRLF8WbcXVbpB05ZGwriavHWsSGRbg.webp"
                            data-card-name="삼성카드 BIZ 6 V2" data-card-benefit="대표 혜택: 비즈니스, 주유, 통신"
                            data-card-benefits="비즈니스 업종 10%|주유 5%|통신요금 5%">
                            <!-- 데이터 임시 채워둠, 타임리프 변환 시 삭제 -->
                        </div>
                    </div>

                    <div class="compare-plus">+</div>

                    <!-- 비교 카드 -->
                    <div class="compare-card target-card" id="targetCard">
                        <p class="label">비교할 카드 선택</p>
                        <button class="card-box empty" id="openModalBtn" type="button">
                            아래에서 카드를 선택해주세요.
                        </button>
                    </div>
                </div>
            </section>

            <section class="benefit-compare" id="benefitCompare" style="display: none;">
                <h3>혜택 비교 결과</h3>
                <p class="desc">선택한 두 카드의 주요 혜택을 비교해서 보여줍니다.</p>

                <div class="benefit-compare-grid">
                    <div class="benefit-column" id="currentBenefits">
                        <h4>현재 카드</h4>
                        <ul class="benefit-list">
                            <li class="placeholder">위 카드 정보에서 불러오는 중...</li>
                        </ul>
                    </div>
                    <div class="benefit-column" id="targetBenefits">
                        <h4>비교할 카드</h4>
                        <ul class="benefit-list">
                            <li class="placeholder">오른쪽 카드 선택 시 표시됩니다.</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- 모달 -->
            <div class="card-modal-overlay" id="cardModal">
                <div class="card-modal">
                    <div class="card-modal-header">
                        <h3>비교할 카드 선택</h3>
                        <button class="close-modal" id="closeModalBtn" type="button">×</button>
                    </div>
                    <div class="card-modal-body">
                        <!-- 여기가 카드 목록 -->
                        <button class="modal-card-item" data-card-name="삼성카드 탭탭 O" data-card-benefit="커피/스트리밍 특화"
                            data-card-benefits="카페 20%|스트리밍 20%|배달앱 5%"
                            data-card-img="https://i.namu.wiki/i/IAJvonqqxo949GavmMtyQOX05yvPs8vXZpJWZ5orEB4ZUMzsEUpj3D6osRLF8WbcXVbpB05ZGwriavHWsSGRbg.webp">
                            <span class="item-thumb">O</span>
                            <span class="item-text">
                                <span class="item-name">삼성카드 탭탭 O</span>
                                <span class="item-benefit">커피/스트리밍 특화</span>
                            </span>
                        </button>

                        <button class="modal-card-item" data-card-name="삼성카드 미니멀" data-card-benefit="교통/편의점"
                            data-card-benefits="대중교통 10%|편의점 5%|통신요금 3%"
                            data-card-img="https://static11.samsungcard.com/wcms/home/scard/image/personal/IDON_AAP1731.gif">
                            <span class="item-thumb">M</span>
                            <span class="item-text">
                                <span class="item-name">삼성카드 미니멀</span>
                                <span class="item-benefit">교통/편의점</span>
                            </span>
                        </button>

                        <button class="modal-card-item" data-card-name="삼성카드 주유 플러스" data-card-benefit="주유 특화"
                            data-card-img="https://static11.samsungcard.com/wcms/home/scard/image/personal/IDON_AAP1731.gif">
                            <span class="item-thumb">P</span>
                            <span class="item-text">
                                <span class="item-name">삼성카드 주유 플러스</span>
                                <span class="item-benefit">주유 특화</span>
                            </span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- 하단 고정 버튼 -->
            <div class="floating-apply">
                <button type="button" class="btn-main">카드신청</button>
                <button type="button" class="btn-sub">뒤로가기</button>
            </div>
        </div>
    </main>

    <div class="fee-modal" id="feeModal"><!-- 연회비 모달창-->
        <div class="fee-modal-dim" id="feeDim"></div>

        <div class="fee-modal-box">
            <div class="fee-modal-header">
                <h2>연회비</h2>
                <button type="button" class="fee-modal-close" id="feeClose">✕</button>
            </div>

            <div class="fee-modal-body">
                <div class="fee-item">
                    <h3>국내외겸용(Visa Signature) 300,000원</h3>
                    <p class="fee-sub">(기본연회비 100,000원 + 제휴연회비 200,000원)</p>
                    <p class="fee-sub">가족카드 100,000원(기본연회비 0원 + 제휴연회비 100,000원)</p>
                </div>

                <div class="fee-line"></div>

                <div class="fee-item">
                    <h3>국내전용 300,000원</h3>
                    <p class="fee-sub">(기본연회비 100,000원 + 제휴연회비 200,000원)</p>
                    <p class="fee-sub">가족카드 100,000원(기본연회비 0원 + 제휴연회비 100,000원)</p>
                </div>

                <ul class="fee-notice">
                    <li>카드 연회비(기본연회비 + 제휴연회비)는 카드 발급 시 선청구되며, 보유 카드별로 청구</li>
                    <li>기본연회비는 카드의 발행, 배송 등 발급에 소요된 비용으로, 발급 첫 해에 카드 해지 시에도 반환되지 않음</li>
                </ul>
            </div>
        </div>
    </div>


    <div id="footer"></div>

    <script> // 헤더 푸터 연결

        document.addEventListener('DOMContentLoaded', function () {
            // header 로드
            fetch('../common/header.html')
                .then(res => res.text())
                .then(html => {
                    document.getElementById('header').innerHTML = html;

                    // 스크롤시 헤더 고정 클래스
                    const headerEl = document.querySelector('.header');
                    window.addEventListener('scroll', () => {
                        if (window.scrollY > 10) {
                            headerEl.classList.add('scrolled');
                        } else {
                            headerEl.classList.remove('scrolled');
                        }
                    });
                });

            // footer 로드
            fetch('../common/footer.html')
                .then(res => res.text())
                .then(html => document.getElementById('footer').innerHTML = html);
        });
    </script>

    <script> // 모달창 JS
        document.addEventListener('DOMContentLoaded', function () {
            const openBtn = document.getElementById('openFee');
            const modal = document.getElementById('feeModal');
            const dim = document.getElementById('feeDim');
            const closeBtn = document.getElementById('feeClose');

            if (openBtn) {
                openBtn.addEventListener('click', () => {
                    modal.classList.add('show');
                });
            }

            [dim, closeBtn].forEach(el => {
                el.addEventListener('click', () => {
                    modal.classList.remove('show');
                });
            });
        });
    </script>

    <script> // 카드 유의사항 드롭다운
        document.addEventListener('DOMContentLoaded', function () {
            const head = document.getElementById('cardNoticeToggle');
            const body = document.getElementById('cardNoticeBody');
            const btn = head.querySelector('.card-notice-btn');

            head.addEventListener('click', function () {
                const opened = body.style.maxHeight && body.style.maxHeight !== '0px';

                if (opened) {
                    body.style.maxHeight = '0px';
                    btn.classList.remove('active');
                    btn.setAttribute('aria-expanded', 'false');
                } else {
                    body.style.maxHeight = body.scrollHeight + 'px';
                    btn.classList.add('active');
                    btn.setAttribute('aria-expanded', 'true');
                }
            });
        });
    </script>

    <script> // 카드 비교 모달+결과창 JS
        document.addEventListener('DOMContentLoaded', function () {

            /* ===== 공통 함수 ===== */
            function renderCardBox(boxEl, data) {
                const { img, name, benefit } = data;
                const thumbHtml = img
                    ? `<img src="${img}" alt="${name || ''}" class="card-img">`
                    : `<div class="card-thumb">${(name || 'C').charAt(0)}</div>`;

                boxEl.classList.remove('empty');
                boxEl.innerHTML = `
      ${thumbHtml}
      ${name ? `<h3 class="card-name">${name}</h3>` : ''}
      ${benefit ? `<p class="card-benefit">${benefit}</p>` : ''}
    `;
            }

            function renderBenefits(listEl, benefitsStr) {
                listEl.innerHTML = '';
                if (!benefitsStr) {
                    listEl.innerHTML = `<li class="placeholder">혜택 정보가 없습니다.</li>`;
                    return;
                }
                const arr = benefitsStr.split('|').map(s => s.trim()).filter(Boolean);
                arr.forEach(b => {
                    const li = document.createElement('li');
                    li.textContent = b;
                    listEl.appendChild(li);
                });
            }

            /* ===== 요소 가져오기 ===== */
            const modal = document.getElementById('cardModal');
            const openBtn = document.getElementById('openModalBtn');
            const closeBtn = document.getElementById('closeModalBtn');

            const currentBox = document.querySelector('#currentCard .card-box');
            const targetBox = document.querySelector('#targetCard .card-box');

            const currentBenefitsUl = document.querySelector('#currentBenefits .benefit-list');
            const targetBenefitsUl = document.querySelector('#targetBenefits .benefit-list');
            const benefitCompareSec = document.getElementById('benefitCompare');

            /* ===== 페이지 처음에 현재 카드 채우기 ===== */
            if (currentBox) {
                renderCardBox(currentBox, {
                    img: currentBox.dataset.cardImg || '',
                    name: currentBox.dataset.cardName || '',
                    benefit: currentBox.dataset.cardBenefit || ''
                });
                renderBenefits(currentBenefitsUl, currentBox.dataset.cardBenefits || '');
            }

            /* ===== 모달 열기/닫기 ===== */
            if (openBtn) {
                openBtn.addEventListener('click', () => {
                    modal.style.display = 'flex';
                });
            }
            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    modal.style.display = 'none';
                });
            }

            /* ===== 모달에서 카드 선택 ===== */
            if (modal) {
                modal.addEventListener('click', function (e) {
                    // 배경 클릭 시 닫기
                    if (e.target === modal) {
                        modal.style.display = 'none';
                        return;
                    }

                    const item = e.target.closest('.modal-card-item');
                    if (!item) return;

                    const name = item.dataset.cardName;
                    const benefit = item.dataset.cardBenefit;
                    const img = item.dataset.cardImg;
                    const benefitsStr = item.dataset.cardBenefits || '';

                    // 오른쪽 카드 박스 채우기
                    renderCardBox(targetBox, { img, name, benefit });

                    // 혜택 비교 오른쪽 채우기
                    renderBenefits(targetBenefitsUl, benefitsStr);

                    // ✅ 이 순간에만 비교 섹션 보여주기
                    if (benefitCompareSec) {
                        benefitCompareSec.style.display = 'block';
                    }

                    // 모달 닫기
                    modal.style.display = 'none';
                });
            }

        });
    </script>
</body>

</html>